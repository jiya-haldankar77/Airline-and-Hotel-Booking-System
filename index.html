<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jealous Flights - Book Your Flight</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Arial',sans-serif;background-image:url('https://images.unsplash.com/photo-1558285549-827043e3d8a8?w=600&auto=format&fit=crop&q=60');background-size:cover;background-position:center;background-attachment:fixed;min-height:100vh;}
    .header{background:white;padding:15px 40px;box-shadow:0 2px 10px rgba(0,0,0,0.1);display:flex;justify-content:space-between;align-items:center;}
    .logo{width:120px;height:60px;}
    .logo img{width:100%;height:100%;object-fit:contain;border-radius:10px;}
    .nav-menu{display:flex;gap:30px;align-items:center;}
    .nav-item{color:#333;text-decoration:none;font-weight:500;font-size:14px;cursor:pointer;transition:color .3s;}
    .nav-item:hover{color:#007bff;}
    .login-btn{background:#007bff;color:white;padding:8px 20px;border-radius:5px;border:none;cursor:pointer;font-weight:600;}
    .main-container{max-width:1200px;margin:40px auto;padding:0 20px;}
    .booking-section{background:white;border-radius:10px;box-shadow:0 5px 20px rgba(0,0,0,0.15);overflow:hidden;}
    .tabs{display:flex;background:#f5f5f5;}
    .tab{flex:1;padding:15px 20px;text-align:center;cursor:pointer;font-weight:600;color:#666;transition:all .3s;border-bottom:3px solid transparent;}
    .tab.active{background:#1e3a8a;color:white;border-bottom:3px solid #1e3a8a;}
    .booking-content{padding:30px;}
    .trip-type{display:flex;gap:25px;margin-bottom:25px;}
    .trip-option{display:flex;align-items:center;gap:8px;cursor:pointer;}
    .trip-option input[type=radio]{width:18px;height:18px;cursor:pointer;accent-color:#1e3a8a;}
    .trip-option label{cursor:pointer;font-size:14px;font-weight:500;color:#333;}
    .search-box{background:#f9fafb;padding:25px;border-radius:8px;margin-bottom:20px;}
    .search-row{display:grid;grid-template-columns:2fr 2fr 1.5fr 1.5fr 1.5fr;gap:15px;margin-bottom:20px;}
    .search-field{background:white;border:1px solid #e0e0e0;border-radius:5px;padding:15px;cursor:pointer;transition:all .3s;}
    .search-field:hover{border-color:#1e3a8a;box-shadow:0 2px 8px rgba(30,58,138,.1);}
    .field-label{font-size:11px;color:#666;margin-bottom:5px;display:block;}
    .field-input{width:100%;border:none;outline:none;font-size:16px;font-weight:600;color:#1e3a8a;background:transparent;}
    .search-button{width:100%;padding:15px;background:#1e3a8a;color:white;border:none;border-radius:8px;font-size:16px;font-weight:bold;cursor:pointer;transition:all .3s;text-transform:uppercase;letter-spacing:1px;}
    .search-button:hover{background:#152a6b;transform:translateY(-2px);box-shadow:0 5px 15px rgba(30,58,138,.3);}
    @media(max-width:768px){.search-row{grid-template-columns:1fr;}.nav-menu{display:none;}}
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">
      <img src="https://images.unsplash.com/photo-1572573385781-2fd4f8c1389e?w=600&auto=format&fit=crop&q=60" alt="Jealous Flights">
    </div>
    <div class="nav-menu">
      <a href="#" class="nav-item">Book</a>
      <a href="#" class="nav-item">Trips</a>
      <a href="#" class="nav-item">Deals</a>
      <a href="#" class="nav-item">Check-in</a>
      <button class="login-btn">Login</button>
    </div>
  </div>

  <div class="main-container">
    <div class="booking-section">
      <div class="tabs">
        <div class="tab active">‚úàÔ∏è Flights</div>
        <div class="tab">üè® Hotels</div>
        <div class="tab">üëÅÔ∏è Sight Seeing</div>
      </div>

      <div class="booking-content">
        <div class="trip-type">
          <div class="trip-option"><input type="radio" id="oneWay" name="tripType" checked><label for="oneWay">One Way</label></div>
          <div class="trip-option"><input type="radio" id="roundTrip" name="tripType"><label for="roundTrip">Round Trip</label></div>
          <div class="trip-option"><input type="radio" id="multiCity" name="tripType"><label for="multiCity">Multi City</label></div>
        </div>

        <div class="search-box">
          <form id="flightSearchForm">
            <div class="search-row">
              <div class="search-field">
                <label class="field-label">From</label>
                <select class="field-input" id="from" required>
                  <option value="Delhi">Delhi</option>
                  <option value="Mumbai">Mumbai</option>
                  <option value="Goa">Goa</option>
                  <option value="Chennai">Chennai</option>
                </select>
              </div>
              <div class="search-field">
                <label class="field-label">To</label>
                <select class="field-input" id="to" required>
                  <option value="Delhi">Delhi</option>
                  <option value="Mumbai">Mumbai</option>
                  <option value="Goa">Goa</option>
                  <option value="Chennai">Chennai</option>
                    </select>
              </div>
              <div class="search-field">
                <label class="field-label">Departure</label>
                <input type="date" class="field-input" id="departureDate" required>
              </div>
              <div class="search-field">
                <label class="field-label">Return</label>
                <input type="date" class="field-input" id="returnDate">
              </div>
              <div class="search-field">
                <label class="field-label">Travellers</label>
                <select class="field-input" id="travellers"><option>1</option><option>2</option><option>3</option></select>
              </div>
            </div>
            <button type="submit" class="search-button">Search Flights</button>
          </form>
        </div>
      </div>
    </div>

    <div id="flightResults" style="margin-top:40px;display:none;">
      <h2 style="margin-bottom:20px;color:#1e3a8a;">Available Flights</h2>
      <table border="1" width="100%" style="border-collapse:collapse;text-align:left;">
        <thead style="background:#1e3a8a;color:white;">
          <tr>
            <th>ID</th>
            <th>Flight Name</th>
            <th>Source</th>
            <th>Destination</th>
            <th>Departure</th>
            <th>Arrival</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="flightsTable"></tbody>
      </table>
    </div>
  </div>

  <script>
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('departureDate').setAttribute('min', today);
  document.getElementById('returnDate').setAttribute('min', today);

  document.getElementById('flightSearchForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const from = document.getElementById('from').value;
    const to = document.getElementById('to').value;

    try {
      const res = await fetch("http://localhost:3001/search-flights", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ from, to })
      });
      if (!res.ok) {
        const text = await res.text().catch(() => "");
        throw new Error(`HTTP ${res.status} ${res.statusText}${text ? ` - ${text}` : ""}`);
      }

      let data;
      try {
        data = await res.json();
      } catch (_) {
        throw new Error("Invalid JSON response from server");
      }
      const table = document.getElementById("flightsTable");
      table.innerHTML = "";

      if (data.length === 0) {
        alert("No flights found for this route!");
        document.getElementById('flightResults').style.display = "none";
        return;
      }

      data.forEach(f => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${f.id}</td>
          <td>${f.airline}</td>
          <td>${f.source}</td>
          <td>${f.destination}</td>
          <td>${new Date(f.departure_time).toLocaleString()}</td>
          <td>${new Date(f.arrival_time).toLocaleString()}</td>
          <td>${f.status}</td>
        `;
        table.appendChild(row);
      });

      document.getElementById('flightResults').style.display = "block";
    } catch (err) {
      console.error(err);
      alert(`Error: ${err.message}`);
    }
  });
</script>

</body>
</html>
